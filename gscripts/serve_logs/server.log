[2024-10-28 16:45:53.421] [info] [manager.py:21] Created local system with ['amdgpu:0:0@0'] devices
[2024-10-28 16:45:53.451] [info] [cache.py:78] Allocating page table (shape=[256, 2662400], dtype=float16, size=1.3GiB) on DeviceAffinity(amdgpu:0:0@0[0x1])
[2024-10-28 16:45:53.452] [info] [service.py:64] Loading parameter fiber 'model' from: /tmp/export_and_serve/open-llama-3b-v2-f16.gguf
[2024-10-28 16:45:53.458] [info] [server.py:82] Started server process [753226]
[2024-10-28 16:45:53.458] [info] [on.py:48] Waiting for application startup.
[2024-10-28 16:45:53.458] [info] [manager.py:29] Starting system manager
[2024-10-28 16:45:53.459] [info] [server.py:41] Initializing service 'default': ServiceManager(
  model_params=ModelParams(max_seq_len=2048, transformer_block_count=26, attn_head_count=32, attn_head_dim=100, prefill_batch_sizes=[1, 4], decode_batch_sizes=[1, 4], module_name='module', module_abi_version=1, attn_dtype=float16, paged_kv_cache=PagedKVCacheParams(block_seq_stride=16, device_block_count=256))
  inference_modules=[ProgramModule('module', version=0, exports=[prefill_bs1$async(0rrrrrr_r), prefill_bs1(0rrrr_r), decode_bs1$async(0rrrrrrr_r), decode_bs1(0rrrrr_r), prefill_bs4$async(0rrrrrr_r), prefill_bs4(0rrrr_r), decode_bs4$async(0rrrrrrr_r), decode_bs4(0rrrrr_r), __init(0v_v)])]
  page_cache=AttnPageCache(0/256 pages in use: 100.0% free)
)
[2024-10-28 16:45:54.407] [info] [on.py:62] Application startup complete.
[2024-10-28 16:45:54.408] [info] [server.py:214] Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
[2024-10-28 16:45:57.856] [info] [h11_impl.py:476] 127.0.0.1:56892 - "GET /health HTTP/1.1" 200
[2024-10-28 16:45:57.893] [info] [service.py:395] Printing args
[2024-10-28 16:45:57.893] [info] [service.py:396] Printing tokens
[2024-10-28 16:45:57.893] [info] [service.py:397] [[    1 29500 29532 29500 29536 29500 29556 29500 29562 29500 29561     0
      0     0     0     0]]
[2024-10-28 16:45:57.893] [info] [service.py:398] Printing seq_lens
[2024-10-28 16:45:57.894] [info] [service.py:399] [11]
[2024-10-28 16:45:57.894] [info] [service.py:403] Printing seq_block_ids
[2024-10-28 16:45:57.894] [info] [service.py:404] [[255]]
[2024-10-28 16:45:57.894] [info] [service.py:409] INVOKE ProgramFunction(prefill_bs1$async: 0rrrrrr_r): 
  0: [1, 16]
  1: [1]
  2: [1, 1]
  3: [256, 2662400]
[2024-10-28 16:45:58.774] [info] [service.py:417] INVOKE ProgramFunction(prefill_bs1$async: 0rrrrrr_r): done
[2024-10-28 16:45:58.774] [info] [service.py:418] Token and logit dump after phase: InferencePhase.PREFILL
[2024-10-28 16:45:58.797] [info] [service.py:472] Token ID   Token                Probability
[2024-10-28 16:45:58.797] [info] [service.py:473] ----------------------------------------
[2024-10-28 16:45:58.797] [info] [service.py:478] 29500      ▁                    0.8447
[2024-10-28 16:45:58.797] [info] [service.py:478] 13         <0x0A>               0.0247
[2024-10-28 16:45:58.797] [info] [service.py:478] 5431       ▁Next                0.0181
[2024-10-28 16:45:58.797] [info] [service.py:478] 1259       ▁>                   0.0110
[2024-10-28 16:45:58.797] [info] [service.py:478] 2132       ▁...                 0.0106
[2024-10-28 16:45:58.797] [info] [service.py:478] 3319       ▁…                   0.0103
[2024-10-28 16:45:58.797] [info] [service.py:478] 4306       ▁»                   0.0091
[2024-10-28 16:45:58.797] [info] [service.py:478] 17809      ▁›                   0.0052
[2024-10-28 16:45:58.797] [info] [service.py:478] 2          </s>                 0.0030
[2024-10-28 16:45:58.797] [info] [service.py:478] 827        ▁|                   0.0029
[2024-10-28 16:45:58.799] [info] [service.py:179] Waiting a bit longer to fill flight
[2024-10-28 16:45:59.045] [info] [service.py:395] Printing args
[2024-10-28 16:45:59.046] [info] [service.py:396] Printing tokens
[2024-10-28 16:45:59.047] [info] [service.py:397] [[29500]]
[2024-10-28 16:45:59.047] [info] [service.py:398] Printing seq_lens
[2024-10-28 16:45:59.047] [info] [service.py:399] [1]
[2024-10-28 16:45:59.047] [info] [service.py:401] Printing start_positions
[2024-10-28 16:45:59.047] [info] [service.py:402] [11]
[2024-10-28 16:45:59.047] [info] [service.py:403] Printing seq_block_ids
[2024-10-28 16:45:59.048] [info] [service.py:404] [[255]]
[2024-10-28 16:45:59.048] [info] [service.py:409] INVOKE ProgramFunction(decode_bs1$async: 0rrrrrrr_r): 
  0: [1, 1]
  1: [1]
  2: [1]
  3: [1, 1]
  4: [256, 2662400]
[2024-10-28 16:45:59.123] [info] [service.py:417] INVOKE ProgramFunction(decode_bs1$async: 0rrrrrrr_r): done
[2024-10-28 16:45:59.124] [info] [service.py:418] Token and logit dump after phase: InferencePhase.DECODE
[2024-10-28 16:45:59.142] [info] [service.py:472] Token ID   Token                Probability
[2024-10-28 16:45:59.142] [info] [service.py:473] ----------------------------------------
[2024-10-28 16:45:59.142] [info] [service.py:478] 29536      2                    0.0866
[2024-10-28 16:45:59.142] [info] [service.py:478] 29532      1                    0.0776
[2024-10-28 16:45:59.142] [info] [service.py:478] 29520      .                    0.0588
[2024-10-28 16:45:59.142] [info] [service.py:478] 29529      0                    0.0527
[2024-10-28 16:45:59.142] [info] [service.py:478] 13         <0x0A>               0.0460
[2024-10-28 16:45:59.142] [info] [service.py:478] 29561      5                    0.0275
[2024-10-28 16:45:59.142] [info] [service.py:478] 29556      3                    0.0273
[2024-10-28 16:45:59.142] [info] [service.py:478] 29522      ,                    0.0188
[2024-10-28 16:45:59.142] [info] [service.py:478] 29562      4                    0.0173
[2024-10-28 16:45:59.142] [info] [service.py:478] 29525      -                    0.0148
[2024-10-28 16:45:59.145] [info] [service.py:179] Waiting a bit longer to fill flight
[2024-10-28 16:45:59.295] [info] [service.py:179] Waiting a bit longer to fill flight
[2024-10-28 16:45:59.546] [info] [service.py:395] Printing args
[2024-10-28 16:45:59.546] [info] [service.py:396] Printing tokens
[2024-10-28 16:45:59.547] [info] [service.py:397] [[29536]]
[2024-10-28 16:45:59.547] [info] [service.py:398] Printing seq_lens
[2024-10-28 16:45:59.547] [info] [service.py:399] [1]
[2024-10-28 16:45:59.547] [info] [service.py:401] Printing start_positions
[2024-10-28 16:45:59.547] [info] [service.py:402] [12]
[2024-10-28 16:45:59.547] [info] [service.py:403] Printing seq_block_ids
[2024-10-28 16:45:59.548] [info] [service.py:404] [[255]]
[2024-10-28 16:45:59.548] [info] [service.py:409] INVOKE ProgramFunction(decode_bs1$async: 0rrrrrrr_r): 
  0: [1, 1]
  1: [1]
  2: [1]
  3: [1, 1]
  4: [256, 2662400]
[2024-10-28 16:45:59.623] [info] [service.py:417] INVOKE ProgramFunction(decode_bs1$async: 0rrrrrrr_r): done
[2024-10-28 16:45:59.623] [info] [service.py:418] Token and logit dump after phase: InferencePhase.DECODE
[2024-10-28 16:45:59.643] [info] [service.py:472] Token ID   Token                Probability
[2024-10-28 16:45:59.643] [info] [service.py:473] ----------------------------------------
[2024-10-28 16:45:59.643] [info] [service.py:478] 353        ▁(                   0.0040
[2024-10-28 16:45:59.643] [info] [service.py:478] 13         <0x0A>               0.0014
[2024-10-28 16:45:59.643] [info] [service.py:478] 29537      :                    0.0008
[2024-10-28 16:45:59.643] [info] [service.py:478] 29520      .                    0.0008
[2024-10-28 16:45:59.643] [info] [service.py:478] 29522      ,                    0.0007
[2024-10-28 16:45:59.643] [info] [service.py:478] 7868       ▁infrast             0.0007
[2024-10-28 16:45:59.643] [info] [service.py:478] 29500      ▁                    0.0007
[2024-10-28 16:45:59.643] [info] [service.py:478] 29508      s                    0.0006
[2024-10-28 16:45:59.643] [info] [service.py:478] 14802      ▁hier                0.0005
[2024-10-28 16:45:59.643] [info] [service.py:478] 29502      t                    0.0005
[2024-10-28 16:45:59.646] [info] [service.py:179] Waiting a bit longer to fill flight
[2024-10-28 16:45:59.795] [info] [service.py:179] Waiting a bit longer to fill flight
[2024-10-28 16:46:00.046] [info] [service.py:395] Printing args
[2024-10-28 16:46:00.046] [info] [service.py:396] Printing tokens
[2024-10-28 16:46:00.047] [info] [service.py:397] [[353]]
[2024-10-28 16:46:00.047] [info] [service.py:398] Printing seq_lens
[2024-10-28 16:46:00.047] [info] [service.py:399] [1]
[2024-10-28 16:46:00.047] [info] [service.py:401] Printing start_positions
[2024-10-28 16:46:00.047] [info] [service.py:402] [13]
[2024-10-28 16:46:00.047] [info] [service.py:403] Printing seq_block_ids
[2024-10-28 16:46:00.048] [info] [service.py:404] [[255]]
[2024-10-28 16:46:00.048] [info] [service.py:409] INVOKE ProgramFunction(decode_bs1$async: 0rrrrrrr_r): 
  0: [1, 1]
  1: [1]
  2: [1]
  3: [1, 1]
  4: [256, 2662400]
[2024-10-28 16:46:00.123] [info] [service.py:417] INVOKE ProgramFunction(decode_bs1$async: 0rrrrrrr_r): done
[2024-10-28 16:46:00.123] [info] [service.py:418] Token and logit dump after phase: InferencePhase.DECODE
[2024-10-28 16:46:00.142] [info] [service.py:472] Token ID   Token                Probability
[2024-10-28 16:46:00.142] [info] [service.py:473] ----------------------------------------
[2024-10-28 16:46:00.142] [info] [service.py:478] 353        ▁(                   0.0110
[2024-10-28 16:46:00.142] [info] [service.py:478] 13         <0x0A>               0.0057
[2024-10-28 16:46:00.142] [info] [service.py:478] 29520      .                    0.0028
[2024-10-28 16:46:00.142] [info] [service.py:478] 29522      ,                    0.0025
[2024-10-28 16:46:00.142] [info] [service.py:478] 29537      :                    0.0025
[2024-10-28 16:46:00.143] [info] [service.py:478] 29500      ▁                    0.0021
[2024-10-28 16:46:00.143] [info] [service.py:478] 29508      s                    0.0018
[2024-10-28 16:46:00.143] [info] [service.py:478] 29532      1                    0.0015
[2024-10-28 16:46:00.143] [info] [service.py:478] 260        ▁a                   0.0015
[2024-10-28 16:46:00.143] [info] [service.py:478] 268        ▁the                 0.0012
[2024-10-28 16:46:00.145] [info] [service.py:179] Waiting a bit longer to fill flight
[2024-10-28 16:46:00.296] [info] [service.py:179] Waiting a bit longer to fill flight
[2024-10-28 16:46:00.547] [info] [service.py:395] Printing args
[2024-10-28 16:46:00.547] [info] [service.py:396] Printing tokens
[2024-10-28 16:46:00.548] [info] [service.py:397] [[353]]
[2024-10-28 16:46:00.548] [info] [service.py:398] Printing seq_lens
[2024-10-28 16:46:00.548] [info] [service.py:399] [1]
[2024-10-28 16:46:00.548] [info] [service.py:401] Printing start_positions
[2024-10-28 16:46:00.548] [info] [service.py:402] [14]
[2024-10-28 16:46:00.548] [info] [service.py:403] Printing seq_block_ids
[2024-10-28 16:46:00.549] [info] [service.py:404] [[255]]
[2024-10-28 16:46:00.549] [info] [service.py:409] INVOKE ProgramFunction(decode_bs1$async: 0rrrrrrr_r): 
  0: [1, 1]
  1: [1]
  2: [1]
  3: [1, 1]
  4: [256, 2662400]
[2024-10-28 16:46:00.624] [info] [service.py:417] INVOKE ProgramFunction(decode_bs1$async: 0rrrrrrr_r): done
[2024-10-28 16:46:00.624] [info] [service.py:418] Token and logit dump after phase: InferencePhase.DECODE
[2024-10-28 16:46:00.644] [info] [service.py:472] Token ID   Token                Probability
[2024-10-28 16:46:00.644] [info] [service.py:473] ----------------------------------------
[2024-10-28 16:46:00.644] [info] [service.py:478] 353        ▁(                   0.0110
[2024-10-28 16:46:00.644] [info] [service.py:478] 13         <0x0A>               0.0057
[2024-10-28 16:46:00.644] [info] [service.py:478] 29520      .                    0.0028
[2024-10-28 16:46:00.644] [info] [service.py:478] 29522      ,                    0.0025
[2024-10-28 16:46:00.644] [info] [service.py:478] 29537      :                    0.0025
[2024-10-28 16:46:00.644] [info] [service.py:478] 29500      ▁                    0.0021
[2024-10-28 16:46:00.644] [info] [service.py:478] 29508      s                    0.0018
[2024-10-28 16:46:00.644] [info] [service.py:478] 29532      1                    0.0015
[2024-10-28 16:46:00.644] [info] [service.py:478] 260        ▁a                   0.0015
[2024-10-28 16:46:00.644] [info] [service.py:478] 268        ▁the                 0.0012
[2024-10-28 16:46:00.647] [info] [service.py:179] Waiting a bit longer to fill flight
[2024-10-28 16:46:00.796] [info] [service.py:179] Waiting a bit longer to fill flight
[2024-10-28 16:46:01.047] [info] [service.py:395] Printing args
[2024-10-28 16:46:01.047] [info] [service.py:396] Printing tokens
[2024-10-28 16:46:01.048] [info] [service.py:397] [[353]]
[2024-10-28 16:46:01.048] [info] [service.py:398] Printing seq_lens
[2024-10-28 16:46:01.048] [info] [service.py:399] [1]
[2024-10-28 16:46:01.048] [info] [service.py:401] Printing start_positions
[2024-10-28 16:46:01.049] [info] [service.py:402] [15]
[2024-10-28 16:46:01.049] [info] [service.py:403] Printing seq_block_ids
[2024-10-28 16:46:01.049] [info] [service.py:404] [[255]]
[2024-10-28 16:46:01.049] [info] [service.py:409] INVOKE ProgramFunction(decode_bs1$async: 0rrrrrrr_r): 
  0: [1, 1]
  1: [1]
  2: [1]
  3: [1, 1]
  4: [256, 2662400]
[2024-10-28 16:46:01.124] [info] [service.py:417] INVOKE ProgramFunction(decode_bs1$async: 0rrrrrrr_r): done
[2024-10-28 16:46:01.124] [info] [service.py:418] Token and logit dump after phase: InferencePhase.DECODE
[2024-10-28 16:46:01.142] [info] [service.py:472] Token ID   Token                Probability
[2024-10-28 16:46:01.143] [info] [service.py:473] ----------------------------------------
[2024-10-28 16:46:01.143] [info] [service.py:478] 353        ▁(                   0.0110
[2024-10-28 16:46:01.143] [info] [service.py:478] 13         <0x0A>               0.0057
[2024-10-28 16:46:01.143] [info] [service.py:478] 29520      .                    0.0028
[2024-10-28 16:46:01.143] [info] [service.py:478] 29522      ,                    0.0025
[2024-10-28 16:46:01.143] [info] [service.py:478] 29537      :                    0.0025
[2024-10-28 16:46:01.143] [info] [service.py:478] 29500      ▁                    0.0021
[2024-10-28 16:46:01.143] [info] [service.py:478] 29508      s                    0.0018
[2024-10-28 16:46:01.143] [info] [service.py:478] 29532      1                    0.0015
[2024-10-28 16:46:01.143] [info] [service.py:478] 260        ▁a                   0.0015
[2024-10-28 16:46:01.143] [info] [service.py:478] 268        ▁the                 0.0012
[2024-10-28 16:46:01.145] [info] [service.py:179] Waiting a bit longer to fill flight
[2024-10-28 16:46:01.297] [info] [service.py:179] Waiting a bit longer to fill flight
[2024-10-28 16:46:01.548] [info] [service.py:395] Printing args
[2024-10-28 16:46:01.548] [info] [service.py:396] Printing tokens
[2024-10-28 16:46:01.548] [info] [service.py:397] [[353]]
[2024-10-28 16:46:01.548] [info] [service.py:398] Printing seq_lens
[2024-10-28 16:46:01.549] [info] [service.py:399] [1]
[2024-10-28 16:46:01.549] [info] [service.py:401] Printing start_positions
[2024-10-28 16:46:01.549] [info] [service.py:402] [16]
[2024-10-28 16:46:01.549] [info] [service.py:403] Printing seq_block_ids
[2024-10-28 16:46:01.549] [info] [service.py:404] [[255]]
[2024-10-28 16:46:01.549] [info] [service.py:409] INVOKE ProgramFunction(decode_bs1$async: 0rrrrrrr_r): 
  0: [1, 1]
  1: [1]
  2: [1]
  3: [1, 1]
  4: [256, 2662400]
[2024-10-28 16:47:30.704] [info] [server.py:258] Shutting down
[2024-10-28 16:47:30.805] [info] [server.py:303] Waiting for background tasks to complete. (CTRL+C to force quit)
